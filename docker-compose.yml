version: '3.8'

services:
  heattrax-scheduler:
    build: .
    container_name: heattrax-scheduler
    restart: unless-stopped
    ports:
      - "4328:4328"  # Web UI port
      - "8080:8080"  # Health check port
    volumes:
      - ./config.yaml:/app/config.yaml:ro
      - ./logs:/app/logs
      - ./state:/app/state
    environment:
      - TZ=America/New_York
      # Web UI configuration (optional overrides)
      # - HEATTRAX_WEB_ENABLED=true
      # - HEATTRAX_WEB_PASSWORD=your_secure_password
      # Uncomment to override config values with environment variables:
      # - HEATTRAX_TAPO_USERNAME=${HEATTRAX_TAPO_USERNAME}
      # - HEATTRAX_TAPO_PASSWORD=${HEATTRAX_TAPO_PASSWORD}
      # - HEATTRAX_LATITUDE=40.7128
      # - HEATTRAX_LONGITUDE=-74.0060
      # - HEATTRAX_THRESHOLD_TEMP_F=34
      # - HEATTRAX_LOG_LEVEL=INFO
      # Note: Device IPs are configured in config.yaml under devices.groups
      # See README.md for full list of supported environment variables
    network_mode: host
    
    # Alternative: Use .env file for all environment variables
    # Create a .env file from .env.example and uncomment the line below:
    # env_file:
    #   - .env
